<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Booking Confirmation</title>
  <style>
    body {
      font-family: system-ui, Arial, sans-serif;
      background: #f7f9fb;
      color: #333;
      display: flex;
      justify-content: center;
      align-items: center;
      flex-direction: column;
      min-height: 100vh;
      margin: 0;
      padding: 1.5rem;
    }
    .card {
      background: white;
      border-radius: 16px;
      box-shadow: 0 8px 24px rgba(0,0,0,0.1);
      max-width: 600px;
      width: 100%;
      padding: 2rem;
      text-align: center;
      animation: fadeIn 0.8s ease;
    }
    h1 { margin-bottom: 0.5rem; }
    h2 { margin-top: 0; color: #0070f3; }
    .loading { color: #777; margin: 1rem 0; }
    .info { text-align: left; margin-top: 1.5rem; line-height: 1.6; }
    .fade { opacity: 0; transition: opacity 0.4s ease-in; }
    @keyframes fadeIn { from {opacity:0; transform:translateY(10px);} to {opacity:1; transform:translateY(0);} }
  </style>
</head>
<body>
  <div class="card">
    <img src="https://planyo-ch.s3.eu-central-2.amazonaws.com/site_logo_68785.png?v=90715" width="140" alt="Logo" />
    <h1>Booking Confirmation</h1>
    <p>Thank you for your booking! Below are your details.</p>
    <div id="loader" class="loading">Loading booking information...</div>
    <div id="content" class="info fade"></div>
    <p style="margin-top:2rem;font-size:0.95rem;color:#666;" id="emailShortlyText">You will receive an email shortly.</p>
  </div>

  <script>
    (async () => {
      try {
        const params = new URLSearchParams(window.location.search);
        const bookingID = params.get("bookingID");
        if (!bookingID) {
          document.getElementById("loader").innerText = "Invalid booking reference.";
          return;
        }

        const res = await fetch(`https://rental-backend-0kz1.onrender.com/bookingpayments/list/${bookingID}`);
        const data = await res.json();

        if (!data || !data.customer) {
          document.getElementById("loader").innerText = "Invalid booking reference.";
          return;
        }

        // ✅ Populate the booking details
        const html = `
          <strong>Booking ID:</strong> ${bookingID}<br>
          <strong>Name:</strong> ${data.customer}<br>
          <strong>Vehicle:</strong> ${data.resource}<br>
          <strong>Start Date:</strong> ${data.start}<br>
          <strong>End Date:</strong> ${data.end}<br>
          <strong>Total:</strong> £${parseFloat(data.total || 0).toFixed(2)}<br>
          <strong>Paid:</strong> £${parseFloat(data.paid || 0).toFixed(2)}<br>
          <strong>Balance:</strong> £${parseFloat(data.balance || 0).toFixed(2)}
        `;
        document.getElementById("loader").style.display = "none";
        const content = document.getElementById("content");
        content.innerHTML = html;
        content.classList.remove("fade");
        content.style.opacity = "1";
      } catch (err) {
        console.error("Fetch error:", err);
        document.getElementById("loader").innerText = "Error loading booking details.";
      }
    })();
  </script>
</body>
</html>

